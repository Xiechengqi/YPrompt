version: '3.8'

services:
  yprompt:
    image: ghcr.io/fish2018/yprompt:latest  
    container_name: yprompt
    restart: unless-stopped
    ports:
      - "80:80"                                # HTTP端口（Sanic直接监听80）
    volumes:
      - ./data:/app/data                        # 持久化数据库与上传文件
    environment:
      # 服务监听配置（容器内部）
      - YPROMPT_PORT=80                        # Sanic直接监听80端口
      - YPROMPT_HOST=0.0.0.0                  

      # 数据库配置
      - DB_TYPE=sqlite
      - SQLITE_DB_PATH=/app/data/yprompt.db     # 容器内的绝对路径（推荐）

      # JWT 密钥（生产环境必须修改为强随机值！）
      - SECRET_KEY=your-very-secure-secret-key-change-it-in-production!!

      # 服务配置
      - WORKERS=1                               # Sanic worker数量
      - AUTO_RELOAD=false                       # 生产环境关闭自动重载
      - DEBUG=false                             # 生产环境关闭调试模式

      # 默认管理员账号（首次启动后建议立即修改）
      - ADMIN_USERNAME=admin
      - ADMIN_PASSWORD=admin123

    networks:
      - yprompt-network

networks:
  yprompt-network:
    driver: bridge